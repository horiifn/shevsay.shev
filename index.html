<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHEVSAY SKINS | Финальный Дизайн</title>
    <link rel="icon" type="image/png" href="https://assets.lis-skins.com/market_images/150567_b.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@800&display=swap');

        :root {
            --bg-color: #0D0D10;
            --surface-color: #16161A;
            --surface-secondary-color: #1F1F24;
            --primary-text-color: #F0F2F5;
            --secondary-text-color: #8A91A0;
            --border-color: #2A2D3A;
            
            --accent-color: #007BFF;
            --accent-color-hover: #0056b3;

            --quality-mil-spec: #4A90E2;
            --quality-restricted: #48BCA0;
            --quality-classified: #E94C4C;
            --quality-prime: #E6A23C;
        }

        body {
            background-color: var(--bg-color);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4' viewBox='0 0 4 4'%3E%3Cpath fill='%231a1b1e' fill-opacity='0.4' d='M1 3h1v1H1V3zm2-2h1v1H3V1z'%3E%3C/path%3E%3C/svg%3E");
            color: var(--primary-text-color);
            font-family: 'Inter', sans-serif;
            margin: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        img {
            pointer-events: none;
            max-width: 100%;
        }

        /* --- ШАПКА САЙТА (КЛАССИЧЕСКАЯ) --- */
        .site-header {
            padding: 15px 40px;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(12px);
            background-color: rgba(13, 13, 16, 0.7);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .logo { 
            width: 70px; 
            height: auto; 
            transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); 
        }
        .logo:hover { 
            transform: scale(1.1) rotate(-8deg); 
        }
        .social-nav { 
            display: flex; 
            gap: 15px; 
        }
        .social-link {
            color: var(--secondary-text-color);
            text-decoration: none;
            font-weight: 500;
            font-size: 1rem;
            padding: 8px 16px;
            border-radius: 8px;
            transition: color 0.3s ease, background-color 0.3s ease;
        }
        .social-link:hover { 
            color: var(--primary-text-color);
            background-color: var(--surface-color);
        }
        
        /* --- НОВАЯ СТРУКТУРА СТРАНИЦЫ --- */
        .page-content {
            display: flex;
            gap: 40px;
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px;
        }

        /* --- ПАНЕЛЬ ФИЛЬТРОВ (ВОЗВРАЩЕНА СЛЕВА) --- */
        .filter-sidebar {
            width: 280px;
            flex-shrink: 0;
            background-color: var(--surface-color);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            padding: 20px;
            height: fit-content; /* Чтобы панель не растягивалась на всю высоту */
            position: sticky;
            top: 100px; /* Отступ от шапки */
        }
        .filter-sidebar h2 {
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0 0 30px 0;
            font-size: 1.2rem;
            color: var(--primary-text-color);
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        .category-filter details { margin-bottom: 5px; }
        .category-filter summary {
            display: flex; justify-content: space-between; align-items: center;
            cursor: pointer; padding: 12px; border-radius: 8px;
            list-style: none; transition: background-color 0.2s ease;
            font-weight: 500;
        }
        .category-filter summary:hover { background-color: var(--surface-secondary-color); }
        .category-filter summary::-webkit-details-marker { display: none; }
        .category-filter summary::after { /* ВОССТАНОВЛЕНА СТРЕЛОЧКА */
            content: ''; width: 16px; height: 16px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%238A91A0' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-size: contain; transition: transform 0.25s ease-in-out;
            flex-shrink: 0;
        }
        details[open] > summary::after { transform: rotate(180deg); }
        .sub-category-list { 
            padding-left: 15px; margin-top: 10px; margin-left: 12px;
            border-left: 1px solid var(--border-color);
        }
        .checkbox-container {
            display: block; position: relative; padding-left: 30px;
            margin: 15px 0 15px 15px; cursor: pointer; font-size: 0.95em;
        }
        .checkbox-container input { position: absolute; opacity: 0; }
        .checkmark {
            position: absolute; top: 1px; left: 0;
            height: 18px; width: 18px;
            background-color: var(--bg-color); border: 2px solid var(--border-color);
            border-radius: 5px; transition: all 0.2s ease;
        }
        .checkbox-container:hover input ~ .checkmark { border-color: var(--accent-color); }
        .checkbox-container input:checked ~ .checkmark { background-color: var(--accent-color); border-color: var(--accent-color); }
        .checkmark:after {
            content: ""; position: absolute; display: none;
            left: 5px; top: 2px; width: 4px; height: 8px;
            border: solid white; border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
        .checkbox-container input:checked ~ .checkmark:after { display: block; }
        
        /* --- ОСНОВНОЙ КОНТЕНТ (Справа) --- */
        .content-area {
            flex-grow: 1;
        }
        .content-area h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            margin: 0 0 10px 0;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }
        .content-area .prompt {
            color: var(--secondary-text-color);
            font-size: 1.1em;
            max-width: 600px;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .skins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        /* --- ИДЕАЛЬНЫЕ КАРТОЧКИ (БЕЗ ИЗМЕНЕНИЙ) --- */
        @keyframes cardFadeInUp {
            from { opacity: 0; transform: translateY(25px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .skin-card {
            background-color: var(--surface-color);
            border-radius: 16px;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            opacity: 0;
            animation: cardFadeInUp 0.5s ease-out forwards;
            animation-delay: calc(var(--delay) * 60ms);
            display: flex;
            flex-direction: column;
        }
        .skin-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px -5px rgba(0,0,0,0.4), 0 0 0 4px var(--rarity-color, var(--accent-color));
        }
        .skin-visuals {
            height: 200px;
            position: relative;
            cursor: pointer;
            clip-path: polygon(0 0, 100% 0, 100% 80%, 0 100%);
        }
        .skin-image-bg {
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, rgba(31, 31, 36, 0.8) 0%, var(--bg-color) 70%);
        }
        .skin-visuals img {
            width: 100%; height: 100%; object-fit: contain;
            padding: 20px; box-sizing: border-box;
            position: relative; z-index: 2;
            transition: transform 0.4s cubic-bezier(0.22, 1, 0.36, 1);
        }
        .skin-card:hover .skin-visuals img { transform: scale(1.15) rotate(3deg); }
        .rarity-tag {
            position: absolute; top: 15px; right: -1px; z-index: 3;
            background-color: var(--rarity-color); color: #fff;
            padding: 6px 14px; font-size: 0.8rem; font-weight: 700;
            border-radius: 6px 0 0 6px; box-shadow: -2px 2px 8px rgba(0,0,0,0.3);
        }
        .skin-info {
            padding: 0 25px 25px 25px; display: flex;
            flex-direction: column; flex-grow: 1; justify-content: space-between;
        }
        .skin-name {
            font-size: 1.2rem; font-weight: 600;
            margin: 0 0 15px 0; min-height: 3.6rem;
        }
        .skin-details {
            display: flex; justify-content: space-between; align-items: center;
            background-color: var(--surface-secondary-color);
            padding: 12px 15px; border-radius: 10px; margin-bottom: 20px;
        }
        .skin-details .price-label {
            font-size: 0.9rem; color: var(--secondary-text-color); font-weight: 500;
        }
        .skin-details .skin-price {
            font-size: 1.3rem; font-weight: 700; color: var(--primary-text-color);
        }
        .card-actions { display: flex; gap: 12px; }
        .buy-button, .inspect-button {
            display: flex; justify-content: center; align-items: center;
            flex: 1; padding: 13px; border-radius: 8px; text-decoration: none;
            font-weight: 600; font-size: 1rem;
            transition: all 0.2s ease; cursor: pointer; border: 2px solid transparent;
        }
        .buy-button { background-color: var(--accent-color); color: white; }
        .buy-button:hover {
            background-color: var(--accent-color-hover); transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }
        .inspect-button {
            background-color: transparent; color: var(--secondary-text-color);
            border-color: var(--border-color);
        }
        .inspect-button:hover {
            border-color: var(--accent-color); color: var(--primary-text-color);
            background-color: rgba(0, 123, 255, 0.1);
        }

        .quality-mil-spec { --rarity-color: var(--quality-mil-spec); }
        .quality-restricted { --rarity-color: var(--quality-restricted); }
        .quality-classified { --rarity-color: var(--quality-classified); }
        .quality-prime { --rarity-color: var(--quality-prime); }
        
        /* Модальное окно */
        .modal-overlay {position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(13, 13, 16, 0.7); backdrop-filter: blur(8px); z-index: 2000; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease;}
        .modal-overlay.show {opacity: 1; visibility: visible;}
        .modal-content {background-color: var(--surface-color); border: 1px solid var(--border-color); border-radius: 16px; padding: 40px; width: 90%; max-width: 650px; text-align: center; transform: scale(0.95) translateY(10px); transition: transform 0.3s cubic-bezier(0.165, 0.84, 0.44, 1); position: relative;}
        .modal-overlay.show .modal-content {transform: scale(1) translateY(0);}
        .modal-image-container img {max-width: 100%; height: auto; max-height: 65vh; margin-bottom: 20px;}
        .modal-content .skin-name {font-size: 2rem; margin: 15px 0 10px;}
        .modal-content .skin-price {font-size: 1.5rem; color: var(--secondary-text-color);}
        .modal-close {position: absolute; top: 15px; right: 20px; font-size: 2.5rem; line-height: 1; color: var(--secondary-text-color); cursor: pointer; transition: transform 0.3s ease, color 0.3s ease;}
        .modal-close:hover {transform: scale(1.1) rotate(90deg); color: var(--primary-text-color);}

        /* Адаптивность */
        @media (max-width: 1024px) {
            .page-content { flex-direction: column; }
            .filter-sidebar { width: auto; position: static; }
        }
        @media (max-width: 768px) {
            .site-header { flex-direction: column; gap: 15px; }
            .page-content { padding: 20px; }
            .content-area h1 { font-size: 2rem; }
            .skins-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header class="site-header">
    <a href="#"><img src="https://assets.lis-skins.com/market_images/150567_b.png" alt="Shevsay Skins Logo" class="logo"></a>
    <nav class="social-nav">
        <a href="https://www.twitch.tv/shevsay" target="_blank" class="social-link">Twitch</a>
        <a href="https://t.me/shevsay" target="_blank" class="social-link">Telegram</a>
        <a href="https://steamcommunity.com/id/ShevTv/" target="_blank" class="social-link">Steam</a>
        <a href="https://www.donationalerts.com/r/shevsay" target="_blank" class="social-link">Поддержать</a>
    </nav>
</header>

<div class="page-content">
    <aside class="filter-sidebar" id="filterSidebar"></aside>

    <main class="content-area">
        <h1 id="contentTitle"></h1>
        <p class="prompt" id="contentPrompt"></p>
        <div class="skins-grid" id="skinsGrid"></div>
    </main>
</div>

<!-- Модальное окно -->
<div class="modal-overlay" id="skinModal">
    <div class="modal-content">
        <span class="modal-close" id="modalClose">×</span>
        <div class="modal-image-container">
            <img id="modalImage" src="" alt="Skin Image">
        </div>
        <h2 id="modalName" class="skin-name"></h2>
        <p id="modalPrice" class="skin-price"></p>
    </div>
</div>


<script>
    const filterData = {
        'Ножи': ['Bayonet', 'Bowie Knife', 'Butterfly Knife', 'Classic Knife', 'Falchion Knife', 'Flip Knife', 'Gut Knife', 'Huntsman Knife', 'Karambit', 'Kukri Knife', 'M9 Bayonet', 'Navaja Knife', 'Nomad Knife', 'Paracord Knife', 'Shadow Daggers', 'Skeleton Knife', 'Stiletto Knife', 'Survival Knife', 'Talon Knife', 'Ursus Knife'],
        'Перчатки': ['Bloodhound Gloves', 'Broken Fang Gloves', 'Driver Gloves', 'Hand Wraps', 'Hydra Gloves', 'Moto Gloves', 'Specialist Gloves', 'Sport Gloves'],
        'Пистолеты': ['CZ75-Auto', 'Desert Eagle', 'Dual Berettas', 'Five-SeveN', 'Glock-18', 'P2000', 'P250', 'R8 Revolver', 'Tec-9', 'USP-S'],
        'ПП': ['MAC-10', 'MP5-SD', 'MP7', 'MP9', 'P90', 'PP-Bizon', 'UMP-45'],
        'Винтовки': ['AK-47', 'AUG', 'FAMAS', 'G3SG1', 'Galil AR', 'M4A1-S', 'M4A4', 'SCAR-20', 'SG 553'],
        'Снайперки': ['AWP', 'SSG 08'],
        'Дробовики': ['MAG-7', 'Nova', 'Sawed-Off', 'XM1014'],
        'Пулеметы': ['M249', 'Negev'],
        'Другое': ['Агент', 'Брелок', 'Граффити', 'Кейсы', 'Капсулы', 'Наклейки', 'Прайм статус']
    };
    const rarityNames = { 'mil-spec': 'Армейское', 'restricted': 'Запрещенное', 'classified': 'Засекреченное', 'prime': 'Прайм' };
    
    const skins = [
        { name: "SG 553 | Старина Ржавчик", price: 2000, image: "https://assets.lis-skins.com/market_images/147018_b.png", quality: "mil-spec", type: 'SG 553', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572722737A45030988106D2352757034773417469" },
        { name: "M4A1-S | Северный лес", price: 3000, image: "https://assets.lis-skins.com/market_images/9254_b.png", quality: "mil-spec", type: 'M4A1-S', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199303684554A44905774809D16296880026125316388" },
        { name: "USP-S | Билет в ад", price: 5000, image: "https://assets.lis-skins.com/market_images/152529_b.png", quality: "restricted", type: 'USP-S', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199438776871A45024021638D6930585498007975757" },
        { name: "AWP | Капилляры", price: 6500, image: "https://assets.lis-skins.com/market_images/145952_b.png", quality: "mil-spec", type: 'AWP', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572539934A45225672298D7953429965043849259" },
        { name: "AWP | Ахерон", price: 7000, image: "https://assets.lis-skins.com/market_images/60231_b.png", quality: "mil-spec", type: 'AWP', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572896403A45159972133D7083188519541208581" },
        { name: "M4A1-S | Нитро", price: 8000, image: "https://assets.lis-skins.com/market_images/9352_b.png", quality: "restricted", type: 'M4A1-S', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572287354A45195408169D11595088990574181802" },
        { name: "Desert Eagle | Рельсотрон", price: 14000, image: "https://assets.lis-skins.com/market_images/141501_b.png", quality: "restricted", type: 'Desert Eagle', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199440151155A45128185757D6928826125758235369" },
        { name: "M4A1-S | Ночной ужас", price: 17000, image: "https://assets.lis-skins.com/market_images/152536_b.png", quality: "restricted", type: 'M4A1-S', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572819281A45080235516D7254221815132699524" },
        { name: "AK-47 | Затерянная земля", price: 18000, image: "https://assets.lis-skins.com/market_images/141457_b.png", quality: "mil-spec", type: 'AK-47', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572434062A44885517882D875563960137574909" },
        { name: "M4A4 | Мастер травли", price: 20000, image: "https://assets.lis-skins.com/market_images/169019_b.png", quality: "restricted", type: 'M4A4', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572630510A45151099175D778032169458304708" },
        { name: "Glock-18 | Ядерный сад", price: 25000, image: "https://assets.lis-skins.com/market_images/60260_b.png", quality: "classified", type: 'Glock-18', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572445118A45094219615D10125937820632625068" },
        { name: "USP-S | Сайрекс", price: 25000, image: "https://assets.lis-skins.com/market_images/16349_b.png", quality: "classified", type: 'USP-S', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199573451498A45097115098D6937338527307919745" },
        { name: "AWP | Экзоскелет", price: 79999, image: "https://assets.lis-skins.com/market_images/148247_b.png", quality: "classified", type: 'AWP', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572102697A45093761532D7559864608688361997" },
        { name: "AK-47 | Ледяной Уголь", price: 85000, image: "https://assets.lis-skins.com/market_images/156705_b.png", quality: "classified", type: 'AK-47', inspectLink: "steam://rungame/730/76561202255233023/+csgo_econ_action_preview%20S76561199572723112A45089616112D5242903052168340793" },
        { name: "Прайм статус в CS2", price: 199999, image: "https://assets.lis-skins.com/market_images/150602_b.png", quality: "prime", type: 'Прайм статус' }
    ];

    document.addEventListener('DOMContentLoaded', () => {
        const grid = document.getElementById('skinsGrid');
        const filterSidebar = document.getElementById('filterSidebar');
        const contentTitle = document.getElementById('contentTitle');
        const contentPrompt = document.getElementById('contentPrompt');
        
        const modal = document.getElementById('skinModal');
        const modalClose = document.getElementById('modalClose');
        const modalImage = document.getElementById('modalImage');
        const modalName = document.getElementById('modalName');
        const modalPrice = document.getElementById('modalPrice');

        // ВОССТАНОВЛЕНА ЛОГИКА ИЗБРАННЫХ СКИНОВ
        const featuredSkins = ['Прайм статус в CS2', 'AK-47 | Ледяной Уголь', 'AWP | Экзоскелет'];
        let activeFilters = { types: new Set() };

        document.addEventListener('contextmenu', event => event.preventDefault());

        function openModal(skin) {
            modalImage.src = skin.image;
            modalName.textContent = skin.name;
            modalPrice.textContent = `${skin.price.toLocaleString('ru-RU')} баллов`;
            modal.classList.add('show');
        }

        function closeModal() {
            modal.classList.remove('show');
        }

        // ОБНОВЛЕНА ЛОГИКА РЕНДЕРИНГА
        function renderSkins() {
            grid.innerHTML = '';
            const isFiltered = activeFilters.types.size > 0;
            let skinsToRender;

            if (!isFiltered) {
                // Если фильтры не активны, показываем избранные скины
                skinsToRender = skins.filter(s => featuredSkins.includes(s.name));
                contentTitle.textContent = "Избранное";
                contentPrompt.textContent = "Добро пожаловать! Ниже представлены избранные награды. Чтобы найти больше скинов, воспользуйтесь фильтрами.";
                contentPrompt.style.display = 'block';
            } else {
                // Если фильтры активны, показываем результаты поиска
                skinsToRender = skins.filter(skin => activeFilters.types.has(skin.type));
                contentTitle.textContent = "Результаты поиска";
                contentPrompt.style.display = 'none';
            }

            if (skinsToRender.length === 0 && isFiltered) {
                grid.innerHTML = '<p class="prompt">По вашему запросу ничего не найдено. Попробуйте изменить фильтры.</p>';
            }

            skinsToRender.forEach((skin, index) => {
                const card = document.createElement('div');
                card.className = `skin-card quality-${skin.quality || 'default'}`;
                card.style.setProperty('--delay', index);
                const rarityName = rarityNames[skin.quality] || '';
                card.dataset.skinIndex = skins.indexOf(skin);

                let actionsHTML = '';
                if (skin.inspectLink) {
                    actionsHTML = `
                        <a href="${skin.inspectLink}" class="inspect-button">Осмотреть</a>
                        <a href="https://www.twitch.tv/shevsay" target="_blank" class="buy-button">Купить</a>
                    `;
                } else {
                    actionsHTML = `<a href="https://www.twitch.tv/shevsay" target="_blank" class="buy-button" style="flex: auto;">Купить</a>`;
                }
                
                card.innerHTML = `
                    <div class="skin-visuals">
                        <div class="skin-image-bg"></div>
                        <img src="${skin.image}" alt="${skin.name}" loading="lazy">
                        ${rarityName ? `<div class="rarity-tag">${rarityName}</div>` : ''}
                    </div>
                    <div class="skin-info">
                        <div>
                            <h2 class="skin-name">${skin.name}</h2>
                            <div class="skin-details">
                                <span class="price-label">Цена:</span>
                                <span class="skin-price">${skin.price.toLocaleString('ru-RU')}</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            ${actionsHTML}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
        
        // ОБНОВЛЕНА ЛОГИКА СОЗДАНИЯ ФИЛЬТРОВ
        function createFilters() {
            filterSidebar.innerHTML = '<h2>Фильтры</h2>';
            const categoryGroup = document.createElement('div');
            categoryGroup.className = 'category-filter';

            for (const category in filterData) {
                const details = document.createElement('details');
                const subTypes = filterData[category];
                
                let subListHTML = '';
                if (subTypes.length > 0) {
                    const subList = document.createElement('div');
                    subList.className = 'sub-category-list';
                    subTypes.forEach(type => {
                        subList.innerHTML += `
                            <label class="checkbox-container"> ${type}
                                <input type="checkbox" data-type-for-category="${category}" value="${type}">
                                <span class="checkmark"></span>
                            </label>
                        `;
                    });
                    details.innerHTML = `<summary>${category}</summary>`;
                    details.appendChild(subList);
                } else {
                     details.innerHTML = `<summary>${category}</summary>`; // Для категорий без подкатегорий, если будут
                }
                categoryGroup.appendChild(details);
            }
            filterSidebar.appendChild(categoryGroup);
        }

        createFilters();
        renderSkins(); // Первоначальный рендер с избранными товарами

        // ОБНОВЛЕНА ЛОГИКА ОБРАБОТКИ ФИЛЬТРОВ
        filterSidebar.addEventListener('change', (e) => {
            if (e.target.type === 'checkbox') {
                const { value, checked } = e.target;
                if (checked) {
                    activeFilters.types.add(value);
                } else {
                    activeFilters.types.delete(value);
                }
                renderSkins();
            }
        });

        grid.addEventListener('click', (e) => {
            if (e.target.closest('.skin-visuals')) {
                const card = e.target.closest('.skin-card');
                const skinIndex = card.dataset.skinIndex;
                if (skinIndex !== undefined) {
                    openModal(skins[skinIndex]);
                }
            }
        });

        modalClose.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => (e.target === modal) && closeModal());
        document.addEventListener('keydown', (e) => (e.key === 'Escape') && closeModal());
    });
</script>

</body>
</html>
